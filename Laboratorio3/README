# Laboratorio 2

## Integrantes

    Pablo Antonio Retamales Jara            ROL: 202173650-6
    Geraldine Fernanda Cornejo Valenzuela   ROL: 202173529-1

## Importante (!)

    * Como ya han mencionado en el foro, y con la misma situación que la tarea 2, no es posible agrupar entidades que no requieren de consola interactiva con una que si debe acceder a un uso interactivo dentro de la misma terminal. Por esto, se tuvo que cambiar las configuraciones jugadorX-servidorX, de esta forma corren en 2 terminales dentro del mismo sistema. Esta es la ÚNICA forma de ejecutar ambas instancias sin problema, a menos que se ejecute la otra en modo detach (-d), pero no tiene sentido ya que se perderia toda la visualización de la terminal del servidor, pues correría en 2ndo plano.

    (!) Dado lo anterior, no es posible ejecutar un
        make docker-jugadorX-servidorX,
    
    (!) Tampoco es posible:
        make docker-admin-matchmaker,
        
    ya que administrador también es un cliente interactivo, por lo que tambien ocurre el mismo problema.

    Nuestra solución fue separar cada uno, por lo que debera ejecutarse dos instrucciones, una en cada terminal separada.

    Estas son las instrucciones disponibles:
        (dist061)
            make docker-servidor1
            make docker-jugador1
        (dist062)
            make docker-servidor2
            make docker-jugador2
        (dist063)
            make docker-servidor3
        (dist064)
            make docker-matchmaker
            make docker-admin
    
    Si bien esto involucra más instrucciones de make y a pesar de lo que se dice en el enunciado sobre ello, en relación a lo comentado en el foro por otro compañero, este sería el camino correcto para solucionar este problema, ya que la única forma posible de crear solo 4 instrucciones make (una por cada VM como se solicita) es ocultando las terminales no interactivas del servidor 1, servidor 2 y el matchmaker, lo cual carece de total sentido.


## Distribución de las VMs

    dist061 -> Jugador1 + Servidor1
    dist062 -> Jugador2 + Servidor2
    dist063 -> Servidor 3
    dist064 -> Administrador y Matchmaker

## Orden sugerido de ejecución
    Es decir, el orden de ejecución sugerido es:
    matchmaker (dist064) -> administrador (dist064) -> servidor3 (dist063)
    ->servidor2 (dist062) -> jugador2 (dist062) -> servidor1(dist061) -> jugador1 (dist061)

    Obligatorio: debe esperar que se levante completamente el contenedor para que funcione, en especial el matchmaker.
    En realidad, para correr los jugadores, es solo necesario que el matchmaker esté levantado, aunque si se une a la cola fallará,
    por esto es necesario ejecutar primero matchmaker, servidores, administrador, y jugadores.


## Instrucciones para ejecución

    Primero, debe ubicarse en la carpeta lab3/{entidad}, es decir, si ejecuta
    docker- , entonces debe estar ubicado en lab3/ .

    Luego, basta con ejecutar el makefile, existen dos instrucciones en la que una
    es opcional.

    Solo es necesario ejecutar:
    (dist061) Usar "make docker-"
    (dist062) Usar "make docker-"
    (dist063) Usar "make docker-"
    (dist064) Usar "make docker-"

    Esto solamente levantará el contenedor que se dejó previamente buildeado en la VM.
    En caso de necesitar ejecutar el build, es muy sencillo, se utiliza:

    (dist061) Usar "make docker-build-"
    (dist062) Usar "make docker-build-"
    (dist063) Usar "make docker-build-"
    (dist064) Usar "make docker-build-"

    Estas son las instrucciones disponibles que son necesarias ejecutar en el orden sugerido en "Orden sugerido de ejecución":
        (dist061)
            make docker-servidor1
            make docker-jugador1
        (dist062)
            make docker-servidor2
            make docker-jugador2
        (dist063)
            make docker-servidor3
        (dist064)
            make docker-matchmaker
            make docker-admin

    Luego, existen las instrucciones para buildear:
        (dist061)
            make docker-build-jugador1-servidor1
        (dist062)
            make docker-build-jugador2-servidor2
        (dist063)
            make docker-build-servidor3
        (dist064)
            make docker-build-admin-matchmaker

    Recordar que estas últimas no deberian ser necesarias, ya que se cargado un build previo.
    Esto se incluye en caso de necesitarlo.

## docker-compose vs docker compose y sudo

    En versiones más recientes de Docker, el sudo docker-compose no funciona,
    la configuración del makefile, es para versiones más recientes de Docker.
    Versiones más recientes incluyen permisos para actuar sin sudo, por lo que funciona
    correcto con 'docker compose up ...' (Sin guión y sin usar sudo)

    En caso de error por usar una versión muy antigua:
    Puede cambiarse por 'sudo docker-compose up --build ...'

    (!) En las VMs, se respeta la versión antigua de Docker, usando
        'sudo docker-compose up ...'
